# Skill: Vulnerability Research

> Systematic approach to finding security vulnerabilities in software, derived from Project Zero methodology.

## When to Use

- Starting security research on a new target (browser, OS, library)
- Conducting a security audit
- Investigating a specific attack surface
- Looking for variants of known vulnerabilities
- Evaluating software security posture

## Prerequisites

- Understanding of the target's architecture
- Familiarity with common vulnerability classes
- Access to source code (preferred) or binary
- Development/debugging environment set up
- Fuzzing infrastructure (optional but recommended)

## Steps

### 1. Define Scope & Goals
```
□ Identify the target component/software
□ Define success criteria (bug classes, severity threshold)
□ Set time boundaries
□ Document initial assumptions
```

### 2. Gather Intelligence
```
□ Review prior vulnerabilities in the target (CVE history)
□ Read existing security research on the target
□ Identify past bug patterns and fixes
□ Note incomplete or suspicious fixes
□ Map the security boundary/threat model
```

### 3. Understand the Target
```
□ Study architecture documentation
□ Read source code (if available)
□ Identify entry points and trust boundaries
□ Map data flows (untrusted input → sensitive operations)
□ Identify privileged operations
□ Note complexity hotspots
```

### 4. Attack Surface Enumeration
```
□ List all input vectors (network, file, IPC, etc.)
□ Identify parsing code (high-value targets)
□ Find state machines and protocol handlers
□ Locate memory management code
□ Map privilege transitions
```

### 5. Hypothesis-Driven Research
```
□ Form hypotheses: "If X, then vulnerability Y"
□ Prioritize by likelihood × impact
□ Design experiments to test hypotheses
□ Document results (positive and negative)
```

### 6. Apply Techniques
```
□ Code auditing (manual review)
□ Fuzzing (coverage-guided, grammar-based)
□ Variant analysis (check fixes for completeness)
□ Differential analysis (compare versions)
□ Symbolic execution (where applicable)
```

### 7. Validate Findings
```
□ Reproduce the bug reliably
□ Determine root cause
□ Assess exploitability
□ Check for variants
□ Document the vulnerability precisely
```

### 8. Document & Report
```
□ Write clear reproduction steps
□ Explain root cause
□ Assess impact/severity
□ Suggest fix approach
□ Follow disclosure process
```

## Techniques Toolbox

| Technique | Best For | Tools |
|-----------|----------|-------|
| Code Auditing | Logic bugs, auth issues | IDE, grep, CodeQL |
| Fuzzing | Memory corruption, parsing | AFL++, libFuzzer, OSS-Fuzz |
| Variant Analysis | Incomplete fixes | Diff tools, git history |
| Taint Analysis | Data flow bugs | CodeQL, Semgrep |
| Symbolic Execution | Path exploration | KLEE, angr |

## Examples

### Good: Systematic Browser Research
```
1. Target: JavaScript engine (V8)
2. Prior art: Read all P0 V8 bugs from past 2 years
3. Attack surface: JIT compiler, garbage collector, built-ins
4. Hypothesis: Type confusion in optimized code paths
5. Technique: Fuzzing + manual review of optimization passes
6. Result: Found new type confusion variant
```

### Good: Variant Analysis
```
1. Start with CVE-2023-XXXX (known vulnerability)
2. Study the fix commit
3. Ask: "Is this fix complete? Are there similar patterns?"
4. Search codebase for similar code
5. Result: Found 3 additional instances of same bug pattern
```

## Anti-patterns

### ❌ Random Poking
```
DON'T: Just run tools without understanding the target
WHY: Low signal-to-noise, miss architectural bugs
```

### ❌ Tunnel Vision
```
DON'T: Focus only on one technique or bug class
WHY: Miss entire categories of vulnerabilities
```

### ❌ Incomplete Analysis
```
DON'T: Stop at first bug, skip variant analysis
WHY: Miss related bugs, leave attack surface exposed
```

### ❌ Poor Documentation
```
DON'T: Keep findings in your head or messy notes
WHY: Can't reproduce, can't communicate, can't learn
```

### ❌ Ignoring "Boring" Code
```
DON'T: Skip parsing, validation, error handling code
WHY: These are often the most vulnerable areas
```

## Metrics

- Hours spent per vulnerability found
- Bug classes discovered
- Variants found per original bug
- False positive rate
- Time to root cause

## References

- Project Zero blog: Methodology posts
- "Five Years of Make 0day Hard" (Black Hat 2019)
- Target-specific prior research
